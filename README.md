# Population synthesis with geographic coordinates

This repository contains the code used to develop the model and analyse the results of "Population synthesis with geographic coordinates".

We propose a generative model of population synthesis based on Normalizing Flows (NF) + Variational Autoencoders (VAE).
NF are used to transform the geographic coordinates in a simple distribution, and VAE is used as generative model.
We compare NF+VAE against 5 benchmarks:
- VAE. Ablation study, removing NF.
- Copula. Gaussian copula synthetizer, using `sdv` package.
- NF+Copula. Gaussian copula synthetizer, using `sdv` package, by transforming the geographic coordinates with NF.
- Shuffle global. Random sample of the real observation with uniform random geographic coordinates.
- Shuffle global. Random sample of the real observation with uniform random geographic coordinates within the same subregion.
All benchmarks are in `src/generation/generate_all_baselines.py`.

The synthetic populations are compared along three axes:
- Fidelity. Measure of the similarity of (i) geographic coordinates `src/evaluation/fidelity_wasserstein.py`, (ii) local features `src/evaluation/fidelity_local_features.py`, (iii) spatial autocorrelation `src/evaluation/fidelity_spatial_autocorrelation.py`. 
- Utility. Train a model on synthetic data and test on real. Similarity between performances of the models trained on real and synthetic data `src/evaluation/utility_hedonic_regression.py`.
- Privacy. Robustness against membership inference attack `src/evaluation/privacy_MIA.py`.

The methods are in the folders `src/generation/` and `src/evaluation/`.

The plots are in `paper/`.

The notebooks used to generate the plots is in `notebooks/`.

Some example maps generated by NF + VAE are in `maps/`.